Цей сценарій конвеєра Jenkins є `Декларативним Конвеєром`, який використовується для автоматизації процесу збірки, тестування та розгортання Java-додатку. Нижче наведено детальний опис скрипта:

### 1. **Визначення Конвеєра**
   - **pipeline { ... }**: Визначає початок конвеєра Jenkins.

### 2. **Оголошення Агента**
   - **agent any**: Вказує, що конвеєр може виконуватися на будь-якому доступному агенті/вузлі Jenkins.

### 3. **Змінні Середовища**
   - **environment { ... }**: Визначає змінні середовища, які будуть доступні протягом усього конвеєра.
     - **APP_PORT = 9090**: Вказує порт, на якому буде працювати додаток (в даному випадку, порт 9090).
     - **APP_DIR = "${env.JOB_NAME}"**: Встановлює змінну `APP_DIR` на ім'я задачі Jenkins (`JOB_NAME`), яке динамічно отримується.

### 4. **Етапи**
   - Конвеєр складається з двох основних етапів: `Build` (Збірка) та `Integration Test` (Інтеграційний Тест).

#### Етап 1: **Build (Збірка)**
   - **stage('Build') { ... }**: Цей етап обробляє компіляцію та упаковку додатка.
     - **steps { ... }**: Визначає кроки, які необхідно виконати на цьому етапі.
       - **echo "START Build Jobname=$JOB_NAME"**: Виводить повідомлення, що вказує на початок процесу збірки, включаючи ім'я задачі.
       - **sh 'mvn -B package -DskipTests'**: Виконує команду Maven для упаковки додатка, пропускаючи тести. Прапорець `-B` означає пакетний режим, який не потребує взаємодії.
       - **stash includes: 'target/*.war', name: 'war_file'**: Зберігає зібраний WAR-файл у Jenkins для подальшого використання на наступних етапах.

#### Етап 2: **Integration Test (Інтеграційний Тест)**
   - **stage('Integration Test') { ... }**: Цей етап виконує паралельні завдання для тестування додатка.
   
   - **parallel { ... }**: Вказує, що етапи всередині цього блоку будуть виконуватися паралельно.

   - **Паралельний Етап 1: Запуск Додатка**
     - **stage('Running Application') { ... }**: Паралельний етап, який запускає додаток.
       - **agent any**: Вказує, що цей етап може виконуватися на будь-якому доступному агенті Jenkins.
       - **options { timeout(time: 60, unit: "SECONDS") }**: Встановлює таймаут на 60 секунд для цього етапу. Якщо етап не завершиться за цей час, він буде перерваний.
       - **steps { ... }**: Кроки, які потрібно виконати на цьому етапі.
         - **echo "START Application"**: Виводить повідомлення про початок запуску додатка.
         - **unstash 'war_file'**: Відновлює раніше збережений WAR-файл.
         - **script { ... }**: Блок для виконання складнішої логіки за допомогою Groovy-скрипта.
           - **try { ... } catch (Throwable e) { ... }**: Намагається запустити додаток та перехоплює будь-які помилки, що виникли.
           - **dir("target") { ... }**: Змінює директорію на `target`.
             - **sh 'pwd'**: Виводить поточну директорію.
             - **sh 'java -jar contact.war'**: Запускає WAR-файл за допомогою Java.
           - **catch блок**: Якщо виникає помилка, вона перехоплюється, виводиться, і результат збірки позначається як "SUCCESS" (успіх).
   
   - **Паралельний Етап 2: Запуск Тесту**
     - **stage('Running Test') { ... }**: Паралельний етап, який запускає інтеграційні тести.
       - **steps { ... }**: Кроки, які потрібно виконати на цьому етапі.
         - **sleep 30**: Очікує 30 секунд, щоб дати додатку час для запуску перед виконанням тестів.
         - **echo "START Test"**: Виводить повідомлення про початок тестування.
         - **sh 'mvn test -Dtest=RestIT'**: Виконує команду Maven для запуску вказаного тесту (`RestIT`), який, ймовірно, є класом інтеграційного тесту.
         - **echo "Done Test"**: Виводить повідомлення про завершення тесту.

### Підсумок:
- **Етап Збірки**: Компілює та упаковує додаток, зберігає результат WAR-файл.
- **Етап Інтеграційного Тестування**: 
  - Виконується паралельно:
    - Запускає додаток з WAR-файлу.
    - Після затримки запускає інтеграційні тести, щоб переконатися, що додаток працює належним чином.
- **Паралельне Виконання**: Етапи `Запуск Додатка` та `Запуск Тесту` виконуються одночасно, що є ефективним підходом та гарантує тестування додатка під час його роботи.
